CREATE DATABASE optica_santa_rita_plantillas;

USE optica_santa_rita_plantillas;

CREATE TABLE roles(
id_rol TINYINT AUTO_INCREMENT NOT NULL,
nombre VARCHAR(15),
CONSTRAINT pk_id_rol PRIMARY KEY (id_rol)
);


CREATE TABLE usuarios(
id_usuario BIGINT AUTO_INCREMENT NOT NULL,
id_rol TINYINT,     
nombre VARCHAR(20) NOT NULL,
apellido VARCHAR(20)NOT NULL,
email VARCHAR(50) NOT NULL,
pass VARCHAR(17) NOT NULL,
calle VARCHAR(20) NOT NULL,
telefono VARCHAR(15)NOT NULL,
CONSTRAINT pk_id_usuario PRIMARY KEY (id_usuario),
CONSTRAINT fk_id_usuario_rol FOREIGN KEY (id_rol) REFERENCES roles (id_rol)    
);

CREATE TABLE clientes(
id_cliente BIGINT AUTO_INCREMENT NOT NULL,
nombre VARCHAR(30) NOT NULL,
apellido VARCHAR(39) NOT NULL,
telefono VARCHAR(15) NOT NULL,
CONSTRAINT pk_id_clientes PRIMARY KEY (id_cliente)    
);

CREATE TABLE lentes(
id_lente BIGINT AUTO_INCREMENT NOT NULL,
medico VARCHAR(30) NOT NULL,
lejos_od VARCHAR(10) NOT NULL ,
lejos_oi VARCHAR(10) NOT NULL,
cerca_od VARCHAR(10) NOT NULL,
cerca_oi VARCHAR(10) NOT NULL,
cilindrico VARCHAR(10) NOT NULL,
en_grados VARCHAR(10) NOT NULL,
distancia VARCHAR(10) NOT NULL,
calibre VARCHAR (10) NOT NULL,
puente VARCHAR (10) NOT NULL,
descripcion VARCHAR(50) DEFAULT "---" , 
fecha DATE NOT NULL,
CONSTRAINT pk_id_lente PRIMARY KEY (id_lente)    
);

CREATE TABLE lentes_x_clientes(
id_lente_x_cliente BIGINT AUTO_INCREMENT NOT NULL,
id_cliente BIGINT,
id_lente BIGINT,
CONSTRAINT pk_de_lentes_x_cliente PRIMARY KEY (id_lente_x_cliente),
CONSTRAINT fk_de_clientes_cliente FOREIGN KEY (id_cliente) REFERENCES clientes (id_cliente),
CONSTRAINT fk_de_lentes_lente FOREIGN KEY (id_lente) REFERENCES lentes (id_lente)
);


CREATE TABLE facturas(
id_factura BIGINT AUTO_INCREMENT NOT NULL,
nombre VARCHAR(30),
fecha DATE NOT NULL,
monto VARCHAR(20) NOT NULL,
descripcion VARCHAR(50) NOT NULL,
CONSTRAINT pk_id_factura PRIMARY KEY (id_factura)    
);

CREATE TABLE facturas_x_clientes(
id_factura_x_cliente BIGINT AUTO_INCREMENT NOT NULL,
id_cliente BIGINT,
id_factura BIGINT,
CONSTRAINT pk_id_factura_x_cliente PRIMARY KEY (id_factura_x_cliente)    
);

CREATE TABLE senias(
id_senia BIGINT AUTO_INCREMENT NOT NULL,
senia VARCHAR(20),
fecha DATE,
CONSTRAINT pk_id_senia PRIMARY KEY (id_senia)   
);

CREATE TABLE senias_x_lentes(
id_senia_x_lente BIGINT AUTO_INCREMENT NOT NULL,
id_lente BIGINT,
id_senia BIGINT,
CONSTRAINT pk_senias_x_lentes PRIMARY KEY (id_senia_x_lente),
CONSTRAINT fk_senias_x_lentes_lente FOREIGN KEY (id_lente) REFERENCES lentes (id_lente),
CONSTRAINT fk_senias_X_lentes_senia FOREIGN KEY (id_senia) REFERENCES senias (id_senia)    
);

